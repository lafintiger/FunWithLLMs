# Advanced Network Traffic and Log Analyzer

A sophisticated analysis tool that combines network packet analysis, log parsing, and Large Language Model (LLM) capabilities through Ollama integration. This tool provides an interactive web interface for analyzing PCAP files and logs, with support for both single-file and batch processing.

## Table of Contents
- [Features](#features)
- [Prerequisites](#prerequisites)
- [Installation](#installation)
- [Usage](#usage)
- [Analysis Types](#analysis-types)
- [Advanced Features](#advanced-features)
- [Troubleshooting](#troubleshooting)
- [Contributing](#contributing)

## Features

### Core Functionality
- Web-based interface using Gradio
- PCAP file analysis with packet-level details
- Log file parsing and pattern recognition
- Integration with local LLMs through Ollama
- Real-time analysis and visualization
- Batch processing capabilities
- Customizable filtering options
- Interactive dashboard generation

### Analysis Capabilities
- Protocol distribution analysis
- Traffic flow visualization
- Port usage statistics
- IP connection mapping
- Pattern recognition
- Anomaly detection
- Security threat identification
- Performance metrics calculation

### Visualization Types
- Protocol distribution pie charts
- Traffic flow network graphs
- Port usage bar charts
- IP frequency visualizations
- Time-series analysis plots
- Connection heat maps

## Prerequisites

### System Requirements
- Python 3.8 or higher
- 4GB RAM minimum (8GB recommended)
- 1GB free disk space
- Operating System: Windows/Linux/MacOS

### Required Software
- Ollama (latest version)
- Python pip package manager
- Git (for version control)

## Installation

1. Clone the repository:
```bash
git clone [repository-url]
cd advanced-log-analyzer
```

2. Create and activate a virtual environment (recommended):
```bash
# Windows
python -m venv venv
.\venv\Scripts\activate

# Linux/MacOS
python3 -m venv venv
source venv/bin/activate
```

3. Install required dependencies:
```bash
pip install -r requirements.txt
```

4. Install and configure Ollama:
- Download from [Ollama's website](https://ollama.ai)
- Install a compatible model:
```bash
ollama pull mistral
# or any other preferred model
```

## Usage

### Starting the Application
```bash
python advancedanalyzer.py
```

The interface will be available at:
- Local URL: http://127.0.0.1:7860
- Public URL: [generated by Gradio when share=True]

### Single File Analysis

1. Upload File:
   - Click "Upload PCAP or Text File"
   - Select your PCAP or log file
   - Maximum recommended file size: 100MB

2. Configure Analysis:
   - Select LLM model from dropdown
   - Choose analysis type
   - Set specific focus areas
   - Configure filters (optional)

3. Advanced Options:
   - Protocol filtering
   - Port filtering
   - IP address filtering
   - Maximum packet limit
   - Visualization preferences

4. View Results:
   - Analysis summary
   - Visualizations
   - Downloadable report
   - Statistical breakdown

### Batch Processing

1. Upload Multiple Files:
   - Select multiple PCAP/log files
   - Configure batch options
   - Set global filters

2. Batch Options:
   - Generate combined dashboard
   - Create individual reports
   - Aggregate statistics

3. View Results:
   - Interactive dashboard
   - Comparative analysis
   - Bulk downloads
   - Combined statistics

## Analysis Types

### Security Audit
- Security breach detection
- Access pattern analysis
- Policy violation checks
- Suspicious activity identification
- Attack signature matching

### Threat Hunting
- APT indicator detection
- C2 traffic identification
- Data exfiltration analysis
- Lateral movement detection
- Privilege escalation monitoring

### Compliance Check
- Access control verification
- Data privacy assessment
- Authentication analysis
- Regulatory compliance
- Data exposure checking

### Performance Analysis
- Resource utilization tracking
- Bottleneck identification
- Error pattern analysis
- Service disruption detection
- Performance metric calculation

## Advanced Features

### Pattern Recognition
```python
common_patterns = {
    'ip_address': r'\b(?:\d{1,3}\.){3}\d{1,3}\b',
    'timestamp': r'\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}',
    'email': r'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b',
    'url': r'https?://(?:[-\w.]|(?:%[\da-fA-F]{2}))+[^\s]*',
    'mac_address': r'(?:[0-9A-Fa-f]{2}[:-]){5}(?:[0-9A-Fa-f]{2})',
    'port': r'\b(?:port |:)\d{1,5}\b',
    'error_codes': r'\b(?:4\d{2}|5\d{2}|error|failure|failed)\b'
}
```

### Filtering Options
- Protocol-based filtering
- Port-based filtering
- IP-based filtering
- Time-based filtering
- Custom regex filters

### Visualization Features
- Interactive plots
- Customizable charts
- Network graphs
- Time series analysis
- Heat maps

## Troubleshooting

### Common Issues

1. Ollama Connection Error
```
Error: Could not connect to Ollama
```
Solution:
- Verify Ollama is running
- Check default port (11434)
- Confirm firewall settings

2. Memory Issues
```
MemoryError: Unable to allocate array
```
Solution:
- Reduce max_packets parameter
- Use file streaming
- Increase system memory

3. File Processing Errors
```
Error parsing PCAP file
```
Solution:
- Check file permissions
- Verify file integrity
- Use compatible file format

### Performance Optimization

1. Large Files:
   - Use streaming processing
   - Implement packet limiting
   - Enable batch processing

2. Memory Usage:
   - Adjust packet buffer size
   - Enable garbage collection
   - Use efficient data structures

3. Processing Speed:
   - Enable parallel processing
   - Optimize filter chains
   - Use indexed searching

## Contributing

### Development Setup
1. Fork the repository
2. Create feature branch
3. Install development dependencies
4. Run tests
5. Submit pull request

### Testing
```bash
python -m pytest tests/
```

### Code Style
- Follow PEP 8
- Use type hints
- Add docstrings
- Comment complex logic

## License
[Your chosen license]

## Acknowledgments
- Gradio team
- Ollama project
- Scapy developers
- NetworkX team
- Seaborn/Matplotlib contributors

## Support
For support:
1. Open GitHub issue
2. Check documentation
3. Join community discussions

---

*For more information and updates, visit the project repository.*